{% load static i18n core_tags %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Zero Waste{% endblock %}</title>

    {% if LANGUAGE_BIDI %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    {% else %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    {% endif %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}?v=13.0">
</head>

<body>
    <div class="d-flex" id="wrapper">

        {% include 'sidebar.html' %}

        <div id="page-content-wrapper">
            {% block content %}
            {% endblock %}
        </div>
    </div>

    <!-- Settings Offcanvas -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="settingsOffcanvas"
        aria-labelledby="settingsOffcanvasLabel">
        <div class="offcanvas-header border-bottom">
            <h5 class="offcanvas-title fw-bold" id="settingsOffcanvasLabel">{{ "الإعدادات"|smart_trans }}</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <!-- Profile Section -->
            <div class="mb-4">
                <h6 class="fw-bold mb-3 text-primary"><i class="bi bi-person-circle me-2"></i>
                    {{"الملف الشخصي"|smart_trans }}</h6>
                <form action="{% url 'core:update_profile' %}" method="POST">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label small text-muted">{{ "اسم المستخدم (Username)"|smart_trans }}</label>
                        <input type="text" name="username" class="form-control form-control-sm"
                            value="{{ user.username }}">
                    </div>
                    <button type="submit" class="btn btn-primary btn-sm w-100 rounded-pill">
                        {{"حفظ التغييرات"|smart_trans }}</button>
                </form>
            </div>

            <hr>

            <!-- Language Section -->
            <div class="mb-4">
                <h6 class="fw-bold mb-3 text-primary"><i class="bi bi-translate me-2"></i> {{ "اللغة"|smart_trans }}
                </h6>
                <form action="{% url 'set_language' %}" method="post">
                    {% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.get_full_path }}">
                    <div class="d-flex gap-2">
                        <button name="language" value="ar"
                            class="btn btn-outline-secondary btn-sm flex-grow-1 {% if LANGUAGE_CODE == 'ar' %}active{% endif %}">{{"العربية"|smart_trans}}</button>
                        <button name="language" value="en"
                            class="btn btn-outline-secondary btn-sm flex-grow-1 {% if LANGUAGE_CODE == 'en' %}active{% endif %}">{{"English"|smart_trans}}</button>
                    </div>
                </form>
            </div>

            <hr>

            <!-- Appearance Section -->
            <div class="mb-4">
                <h6 class="fw-bold mb-3 text-primary"><i class="bi bi-palette me-2"></i> {{ "المظهر"|smart_trans }}</h6>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="themeToggle">
                    <label class="form-check-label" for="themeToggle">{{ "الوضع الداكن (DarkMode)"|smart_trans}}</label>
                </div>
            </div>

            <hr>

            <!-- Security Section -->
            <div class="mb-4">
                <h6 class="fw-bold mb-3 text-primary"><i class="bi bi-shield-lock me-2"></i> {{ "الأمان"|smart_trans }}
                </h6>
                <a href="{% url 'password_reset' %}" class="btn btn-outline-danger btn-sm w-100 rounded-pill">
                    <i class="bi bi-envelope-at me-1"></i> {{"استعادة كلمة المرور"|smart_trans }}
                </a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{% static 'js/dashboard.js' %}"></script>
</body>

</html>